{
  "procedures": {
    "usp_LogEvent": {
      "params": [
        { "name": "@eventType", "type": "VARCHAR(50)" },
        { "name": "@message", "type": "VARCHAR(200)" }
      ],
      "calls": [],
      "tables": ["AuditLog"]
    },
    "usp_UpdateOrderStatus": {
      "params": [
        { "name": "@orderId", "type": "INT" },
        { "name": "@newStatus", "type": "VARCHAR(20)" }
      ],
      "calls": ["usp_LogEvent"],
      "tables": ["Orders"]
    },
    "usp_CloseOrder": {
      "params": [
        { "name": "@orderId", "type": "INT" }
      ],
      "calls": ["usp_UpdateOrderStatus"],
      "tables": []
    }
  },
  "functions": {
    "fn_GetOrderTotalWithAudit": {
      "params": [
        { "name": "@orderId", "type": "INT" }
      ],
      "returns": "DECIMAL(18,2)",
      "calls": ["usp_LogEvent"],
      "tables": ["Orders"]
    },
    "fn_GetOrderWithTax": {
      "params": [
        { "name": "@orderId", "type": "INT" }
      ],
      "returns": "DECIMAL(18,2)",
      "calls": ["fn_GetOrderTotalWithAudit"],
      "tables": []
    }
  },
  "triggers": {
    "trg_AfterInsertOrder": {
      "on_table": "Orders",
      "event": "AFTER INSERT",
      "calls": ["usp_LogEvent", "fn_GetOrderWithTax"],
      "tables": ["Orders"]
    }
  }
}
